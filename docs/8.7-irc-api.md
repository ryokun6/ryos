# IRC Gateway API

The IRC Gateway API bridges the Chats app to the public IRC server at `irc.pieter.com:6667`. It exposes simple HTTP and Server-Sent Events (SSE) endpoints that the frontend uses to connect, send messages, and receive real-time events.

## Overview

- **IRC server:** `irc.pieter.com:6667`
- **Default channel:** `#ryos`
- **Transport:** HTTP + SSE
- **Authentication:** none (nickname-based)

## Endpoints

### POST `/api/irc/connect`

Create a new IRC session and connect to the server.

**Request**
```json
{
  "nick": "ryos_user",
  "channels": ["#ryos", "#general"]
}
```

**Response**
```json
{
  "sessionId": "uuid",
  "nick": "ryos_user",
  "channels": ["#ryos", "#general"]
}
```

---

### GET `/api/irc/stream?sessionId=...`

Open an SSE stream to receive IRC events.

**Event Payloads**
```json
{ "type": "state", "payload": { "state": { "connected": true, "nick": "ryos_user", "channels": ["#ryos"] } } }
```

```json
{ "type": "system", "payload": { "text": "IRC registration successful" } }
```

```json
{
  "type": "message",
  "payload": {
    "id": "uuid",
    "channel": "#ryos",
    "nick": "someone",
    "content": "hello world",
    "timestamp": 1730000000000,
    "type": "message"
  }
}
```

---

### POST `/api/irc/send`

Send a message to an IRC channel.

**Request**
```json
{
  "sessionId": "uuid",
  "channel": "#ryos",
  "content": "hello!"
}
```

**Response**
```json
{ "ok": true }
```

---

### POST `/api/irc/join`

Join a channel.

**Request**
```json
{
  "sessionId": "uuid",
  "channel": "#general"
}
```

**Response**
```json
{ "ok": true }
```

---

### POST `/api/irc/part`

Leave a channel.

**Request**
```json
{
  "sessionId": "uuid",
  "channel": "#general"
}
```

**Response**
```json
{ "ok": true }
```

---

### GET `/api/irc/channels?sessionId=...`

List channels the session is currently in.

**Response**
```json
{
  "channels": [
    {
      "name": "#ryos",
      "topic": "ryOS",
      "users": ["alice", "bob"],
      "userCount": 2
    }
  ]
}
```

## Notes

- Channel names can be provided with or without `#`; the server normalizes them.
- SSE streams include a keepalive ping every 15 seconds.
